{"version":3,"sources":["JqueryPlugin.js"],"names":["define","types","objects","arrays","langx","datax","eventer","plugins","$","pluginUuid","Plugin","inherit","klassName","pluginEventPrefix","options","create","destroy","this","overrided","element","off","eventNamespace","bindings","_construct","defaultElement","uuid","pluginName","classesElementLookup","hoverable","focusable","data","_on","remove","event","target","document","style","ownerDocument","window","defaultView","parentWindow","_create","_trigger","_getCreateEventData","_init","noop","_classes","full","that","processClassString","classes","checkOption","current","i","length","add","each","_","map","elements","some","is","uniq","get","concat","not","push","mixin","keys","match","extra","join","_untrackClassesElement","key","value","inArray","_off","_removeClass","_toggleClass","_addClass","shift","toggleClass","suppressDisabledCheck","handlers","delegateElement","instance","widget","handler","handlerProxy","disabled","hasClass","apply","arguments","guid","eventName","selector","on","split","type","prop","orig","callback","proxy","widgetEventPrefix","toLowerCase","originalEvent","trigger","isFunction","isDefaultPrevented"],"mappings":"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","file":"../JqueryPlugin.js","sourcesContent":["define([\r\n\t\"skylark-langx/types\",\r\n\t\"skylark-langx/objects\",\r\n\t\"skylark-langx/arrays\",\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-utils-dom/datax\",\r\n\t\"skylark-utils-dom/eventer\",\r\n\t\"skylark-utils-dom/plugins\",\r\n\t\"skylark-utils-dom/query\",\r\n],function(types, objects, arrays, langx, datax, eventer, plugins, $){\r\n\r\n    var pluginUuid = 0;\r\n\r\n\tvar JqPlugin = plugins.Plugin.inherit({\r\n\t\tklassName : \"JqPlugin\",\r\n\r\n        pluginEventPrefix: \"\",\r\n\r\n        options: {\r\n            // Callbacks\r\n            create: null\r\n        },\r\n\r\n        destroy: function() {\r\n            this.overrided();\r\n\r\n            // We can probably remove the unbind calls in 2.0\r\n            // all event bindings should go through this._on()\r\n            this.element\r\n                .off( this.eventNamespace );\r\n\r\n            // Clean up events and states\r\n            this.bindings.off( this.eventNamespace );\r\n        },\r\n\r\n        _construct : function(element,options) {\r\n            //this.options = langx.mixin( {}, this.options );\r\n\r\n            element = $( element || this.defaultElement || this )[ 0 ];\r\n\r\n            this.overrided(element,options);\r\n            \r\n            this.element = $( element );\r\n            this.uuid = pluginUuid++;\r\n            this.eventNamespace = \".\" + this.pluginName + this.uuid;\r\n\r\n            this.bindings = $();\r\n            this.classesElementLookup = {};\r\n\r\n\t\t\tthis.hoverable = $();\r\n\t\t\tthis.focusable = $();\r\n\r\n            if ( element !== this ) {\r\n                datax.data( element, this.pluginName, this );\r\n                this._on( true, this.element, {\r\n                    remove: function( event ) {\r\n                        if ( event.target === element ) {\r\n                            this.destroy();\r\n                        }\r\n                    }\r\n                } );\r\n                this.document = $( element.style ?\r\n\r\n                    // Element within the document\r\n                    element.ownerDocument :\r\n\r\n                    // Element is window or document\r\n                    element.document || element );\r\n                this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );\r\n            }\r\n\r\n//            this.options = langx.mixin( {},\r\n//                this.options,\r\n//                this._getCreateOptions(),\r\n//                options );\r\n\r\n            this._create();\r\n\r\n            this._trigger( \"create\", null, this._getCreateEventData() );\r\n\r\n            this._init();\r\n        },\r\n\r\n//        _getCreateOptions: function() {\r\n//            return {};\r\n//        },\r\n\r\n        _getCreateEventData: langx.noop,\r\n\r\n        _create: langx.noop,\r\n\r\n        _init: langx.noop,\r\n\r\n\t\t_classes: function( options ) {\r\n\t\t\tvar full = [];\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toptions = objects.mixin( {\r\n\t\t\t\telement: this.element,\r\n\t\t\t\tclasses: this.options.classes || {}\r\n\t\t\t}, options );\r\n\r\n\r\n\t\t\tfunction bindRemoveEvent() {\r\n\t\t\t\toptions.element.each( function( _, element ) {\r\n\t\t\t\t\tvar isTracked = langx.map( that.classesElementLookup, function( elements ) {\r\n\t\t\t\t\t\treturn elements;\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t\t.some( function(elements ) {\r\n\t\t\t\t\t\t\treturn $(elements).is( element );\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tif ( !isTracked ) {\r\n\t\t\t\t\t\tthat._on( $( element ), {\r\n\t\t\t\t\t\t\tremove: \"_untrackClassesElement\"\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tfunction processClassString( classes, checkOption ) {\r\n\t\t\t\tvar current, i;\r\n\t\t\t\tfor ( i = 0; i < classes.length; i++ ) {\r\n\t\t\t\t\tcurrent = that.classesElementLookup[ classes[ i ] ] || $();\r\n\t\t\t\t\tif ( options.add ) {\r\n\t\t\t\t\t\tbindRemoveEvent();\r\n\t\t\t\t\t\tcurrent = $( langx.uniq( current.get().concat( options.element.get() ) ) );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcurrent = $( current.not( options.element ).get() );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.classesElementLookup[ classes[ i ] ] = current;\r\n\t\t\t\t\tfull.push( classes[ i ] );\r\n\t\t\t\t\tif ( checkOption && options.classes[ classes[ i ] ] ) {\r\n\t\t\t\t\t\tfull.push( options.classes[ classes[ i ] ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.keys ) {\r\n\t\t\t\tprocessClassString( options.keys.match( /\\S+/g ) || [], true );\r\n\t\t\t}\r\n\t\t\tif ( options.extra ) {\r\n\t\t\t\tprocessClassString( options.extra.match( /\\S+/g ) || [] );\r\n\t\t\t}\r\n\r\n\t\t\treturn full.join( \" \" );\r\n\t\t},\r\n\r\n\t\t_untrackClassesElement: function( event ) {\r\n\t\t\tvar that = this;\r\n\t\t\tlangx.each( that.classesElementLookup, function( key, value ) {\r\n\t\t\t\tif ( arrays.inArray( event.target, value ) !== -1 ) {\r\n\t\t\t\t\tthat.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tthis._off( $( event.target ) );\r\n\t\t},\r\n\r\n\t\t_removeClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, false );\r\n\t\t},\r\n\r\n\t\t_addClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, true );\r\n\t\t},\r\n\r\n\t\t_toggleClass: function( element, keys, extra, add ) {\r\n\t\t\tadd = ( typeof add === \"boolean\" ) ? add : extra;\r\n\t\t\tvar shift = ( typeof element === \"string\" || element === null ),\r\n\t\t\t\toptions = {\r\n\t\t\t\t\textra: shift ? keys : extra,\r\n\t\t\t\t\tkeys: shift ? element : keys,\r\n\t\t\t\t\telement: shift ? this.element : element,\r\n\t\t\t\t\tadd: add\r\n\t\t\t\t};\r\n\t\t\toptions.element.toggleClass( this._classes( options ), add );\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_on: function( suppressDisabledCheck, element, handlers ) {\r\n\t\t\tvar delegateElement;\r\n\t\t\tvar instance = this;\r\n\r\n\t\t\t// No suppressDisabledCheck flag, shuffle arguments\r\n\t\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = suppressDisabledCheck;\r\n\t\t\t\tsuppressDisabledCheck = false;\r\n\t\t\t}\r\n\r\n\t\t\t// No element argument, shuffle and use this.element\r\n\t\t\tif ( !handlers ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = this.element;\r\n\t\t\t\tdelegateElement = this.widget();\r\n\t\t\t} else {\r\n\t\t\t\telement = delegateElement = $( element );\r\n\t\t\t\tthis.bindings = this.bindings.add( element );\r\n\t\t\t}\r\n\r\n\t\t\tobjects.each( handlers, function( event, handler ) {\r\n\t\t\t\tfunction handlerProxy() {\r\n\r\n\t\t\t\t\t// Allow widgets to customize the disabled handling\r\n\t\t\t\t\t// - disabled as an array instead of boolean\r\n\t\t\t\t\t// - disabled class as method for disabling individual parts\r\n\t\t\t\t\tif ( !suppressDisabledCheck &&\r\n\t\t\t\t\t\t\t( instance.options.disabled === true ||\r\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n\t\t\t\t\t\t.apply( instance, arguments );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the guid so direct unbinding works\r\n\t\t\t\tif ( typeof handler !== \"string\" ) {\r\n\t\t\t\t\thandlerProxy.guid = handler.guid =\r\n\t\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n\t\t\t\tvar eventName = match[ 1 ] + instance.eventNamespace;\r\n\t\t\t\tvar selector = match[ 2 ];\r\n\r\n\t\t\t\tif ( selector ) {\r\n\t\t\t\t\tdelegateElement.on( eventName, selector, handlerProxy );\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.on( eventName, handlerProxy );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_off: function( element, eventName ) {\r\n\t\t\teventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n\t\t\t\tthis.eventNamespace;\r\n\t\t\telement.off( eventName );\r\n\r\n\t\t\t// Clear the stack to avoid memory leaks (#10056)\r\n\t\t\tthis.bindings = $( this.bindings.not( element ).get() );\r\n\t\t\tthis.focusable = $( this.focusable.not( element ).get() );\r\n\t\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\r\n\t\t},\r\n\r\n\t\t_trigger: function( type, event, data ) {\r\n\t\t\tvar prop, orig;\r\n\t\t\tvar callback = this.options[ type ];\r\n\r\n\t\t\tdata = data || {};\r\n\t\t\tevent = eventer.proxy( event );\r\n\t\t\tevent.type = ( type === this.widgetEventPrefix ?\r\n\t\t\t\ttype :\r\n\t\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\r\n\r\n\t\t\t// The original event may come from any element\r\n\t\t\t// so we need to reset the target on the new event\r\n\t\t\tevent.target = this.element[ 0 ];\r\n\r\n\t\t\t// Copy original event properties over to the new event\r\n\t\t\torig = event.originalEvent;\r\n\t\t\tif ( orig ) {\r\n\t\t\t\tfor ( prop in orig ) {\r\n\t\t\t\t\tif ( !( prop in event ) ) {\r\n\t\t\t\t\t\tevent[ prop ] = orig[ prop ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.trigger( event, data );\r\n\t\t\treturn !( types.isFunction( callback ) &&\r\n\t\t\t\tcallback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n\t\t\t\tevent.isDefaultPrevented() );\r\n\t\t}\r\n\r\n\t});\r\n\r\n\treturn JqPlugin;\r\n});"]}