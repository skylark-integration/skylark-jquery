{"version":3,"sources":["JqueryPlugin.js"],"names":["define","types","objects","arrays","langx","datax","eventer","plugins","$","pluginUuid","Plugin","inherit","klassName","pluginEventPrefix","options","create","destroy","this","overrided","element","off","eventNamespace","bindings","_construct","defaultElement","uuid","pluginName","classesElementLookup","hoverable","focusable","data","_on","remove","event","target","document","style","ownerDocument","window","defaultView","parentWindow","_create","_trigger","_getCreateEventData","_init","_initOptions","mixin","_getCreateOptions","noop","_super","apply","arguments","_superApply","args","_classes","full","that","processClassString","classes","checkOption","current","i","length","add","each","_","map","elements","some","is","uniq","get","concat","not","push","keys","match","extra","join","_untrackClassesElement","key","value","inArray","_off","_removeClass","_toggleClass","_addClass","shift","toggleClass","suppressDisabledCheck","handlers","delegateElement","instance","widget","handler","handlerProxy","disabled","hasClass","guid","eventName","selector","on","split","type","prop","orig","callback","proxy","widgetEventPrefix","toLowerCase","originalEvent","trigger","isFunction","isDefaultPrevented","enable","_setOptions","disable"],"mappings":"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","file":"../JqueryPlugin.js","sourcesContent":["define([\r\n\t\"skylark-langx-types\",\r\n\t\"skylark-langx-objects\",\r\n\t\"skylark-langx-arrays\",\r\n\t\"skylark-langx/langx\",\r\n\t\"skylark-domx-data\",\r\n\t\"skylark-domx-eventer\",\r\n\t\"skylark-domx-plugins-base\",\r\n\t\"skylark-domx-query\",\r\n],function(types, objects, arrays, langx, datax, eventer, plugins, $){\r\n\r\n    var pluginUuid = 0;\r\n\r\n\tvar JqPlugin = plugins.Plugin.inherit({\r\n\t\tklassName : \"JqPlugin\",\r\n\r\n        pluginEventPrefix: \"\",\r\n\r\n        options: {\r\n            // Callbacks\r\n            create: null\r\n        },\r\n\r\n        destroy: function() {\r\n            this.overrided();\r\n\r\n            // We can probably remove the unbind calls in 2.0\r\n            // all event bindings should go through this._on()\r\n            this.element\r\n                .off( this.eventNamespace );\r\n\r\n            // Clean up events and states\r\n            this.bindings.off( this.eventNamespace );\r\n        },\r\n\r\n        _construct : function(element,options) {\r\n            //this.options = langx.mixin( {}, this.options );\r\n\r\n            element = $( element || this.defaultElement || this )[ 0 ];\r\n            this.element = $( element );\r\n            this.uuid = pluginUuid++;\r\n            this.eventNamespace = \".\" + this.pluginName + this.uuid;\r\n\r\n            this.bindings = $();\r\n            this.classesElementLookup = {};\r\n\r\n\t\t\tthis.hoverable = $();\r\n\t\t\tthis.focusable = $();\r\n\r\n            if ( element !== this ) {\r\n                datax.data( element, this.pluginName, this );\r\n                this._on( true, this.element, {\r\n                    remove: function( event ) {\r\n                        if ( event.target === element ) {\r\n                            this.destroy();\r\n                        }\r\n                    }\r\n                } );\r\n                this.document = $( element.style ?\r\n\r\n                    // Element within the document\r\n                    element.ownerDocument :\r\n\r\n                    // Element is window or document\r\n                    element.document || element );\r\n                this.window = $( this.document[ 0 ].defaultView || this.document[ 0 ].parentWindow );\r\n            }\r\n\r\n            this.overrided(element,options);\r\n\r\n//            this.options = langx.mixin( {},\r\n//                this.options,\r\n//                this._getCreateOptions(),\r\n//                options );\r\n\r\n            this._create();\r\n\r\n            this._trigger( \"create\", null, this._getCreateEventData() );\r\n\r\n            this._init();\r\n        },\r\n\r\n\r\n\t     _initOptions : function(options) {\r\n\t     \toptions = langx.mixin(this._getCreateOptions(),options);\r\n\r\n\t\t\tthis.overrided(options);\r\n\t\t},\r\n\r\n        _getCreateOptions: function() {\r\n            return {};\r\n        },\r\n\r\n        _getCreateEventData: langx.noop,\r\n\r\n\t\t_super : function() {\r\n\t\t\tif (this.overrided) {\r\n\t\t\t\treturn this.overrided.apply(this,arguments);\r\n\t\t\t}\r\n\t\t},\r\n\r\n\t\t_superApply : function ( args ) {\r\n\t\t\tif (this.overrided) {\r\n\t\t\t\treturn this.overrided.apply(this,args);\r\n\t\t\t}\r\n\t\t},\r\n\r\n        _create: langx.noop,\r\n\r\n        _init: langx.noop,\r\n\r\n\t\t_classes: function( options ) {\r\n\t\t\tvar full = [];\r\n\t\t\tvar that = this;\r\n\r\n\t\t\toptions = objects.mixin( {\r\n\t\t\t\telement: this.element,\r\n\t\t\t\tclasses: this.options.classes || {}\r\n\t\t\t}, options );\r\n\r\n\r\n\t\t\tfunction bindRemoveEvent() {\r\n\t\t\t\toptions.element.each( function( _, element ) {\r\n\t\t\t\t\tvar isTracked = langx.map( that.classesElementLookup, function( elements ) {\r\n\t\t\t\t\t\treturn elements;\r\n\t\t\t\t\t} )\r\n\t\t\t\t\t\t.some( function(elements ) {\r\n\t\t\t\t\t\t\treturn $(elements).is( element );\r\n\t\t\t\t\t\t} );\r\n\r\n\t\t\t\t\tif ( !isTracked ) {\r\n\t\t\t\t\t\tthat._on( $( element ), {\r\n\t\t\t\t\t\t\tremove: \"_untrackClassesElement\"\r\n\t\t\t\t\t\t} );\r\n\t\t\t\t\t}\r\n\t\t\t\t} );\r\n\t\t\t}\r\n\r\n\t\t\tfunction processClassString( classes, checkOption ) {\r\n\t\t\t\tvar current, i;\r\n\t\t\t\tfor ( i = 0; i < classes.length; i++ ) {\r\n\t\t\t\t\tcurrent = that.classesElementLookup[ classes[ i ] ] || $();\r\n\t\t\t\t\tif ( options.add ) {\r\n\t\t\t\t\t\tbindRemoveEvent();\r\n\t\t\t\t\t\tcurrent = $( langx.uniq( current.get().concat( options.element.get() ) ) );\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tcurrent = $( current.not( options.element ).get() );\r\n\t\t\t\t\t}\r\n\t\t\t\t\tthat.classesElementLookup[ classes[ i ] ] = current;\r\n\t\t\t\t\tfull.push( classes[ i ] );\r\n\t\t\t\t\tif ( checkOption && options.classes[ classes[ i ] ] ) {\r\n\t\t\t\t\t\tfull.push( options.classes[ classes[ i ] ] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ( options.keys ) {\r\n\t\t\t\tprocessClassString( options.keys.match( /\\S+/g ) || [], true );\r\n\t\t\t}\r\n\t\t\tif ( options.extra ) {\r\n\t\t\t\tprocessClassString( options.extra.match( /\\S+/g ) || [] );\r\n\t\t\t}\r\n\r\n\t\t\treturn full.join( \" \" );\r\n\t\t},\r\n\r\n\t\t_untrackClassesElement: function( event ) {\r\n\t\t\tvar that = this;\r\n\t\t\tlangx.each( that.classesElementLookup, function( key, value ) {\r\n\t\t\t\tif ( arrays.inArray( event.target, value ) !== -1 ) {\r\n\t\t\t\t\tthat.classesElementLookup[ key ] = $( value.not( event.target ).get() );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\r\n\t\t\tthis._off( $( event.target ) );\r\n\t\t},\r\n\r\n\t\t_removeClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, false );\r\n\t\t},\r\n\r\n\t\t_addClass: function( element, keys, extra ) {\r\n\t\t\treturn this._toggleClass( element, keys, extra, true );\r\n\t\t},\r\n\r\n\t\t_toggleClass: function( element, keys, extra, add ) {\r\n\t\t\tadd = ( typeof add === \"boolean\" ) ? add : extra;\r\n\t\t\tvar shift = ( typeof element === \"string\" || element === null ),\r\n\t\t\t\toptions = {\r\n\t\t\t\t\textra: shift ? keys : extra,\r\n\t\t\t\t\tkeys: shift ? element : keys,\r\n\t\t\t\t\telement: shift ? this.element : element,\r\n\t\t\t\t\tadd: add\r\n\t\t\t\t};\r\n\t\t\toptions.element.toggleClass( this._classes( options ), add );\r\n\t\t\treturn this;\r\n\t\t},\r\n\r\n\t\t_on: function( suppressDisabledCheck, element, handlers ) {\r\n\t\t\tvar delegateElement;\r\n\t\t\tvar instance = this;\r\n\r\n\t\t\t// No suppressDisabledCheck flag, shuffle arguments\r\n\t\t\tif ( typeof suppressDisabledCheck !== \"boolean\" ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = suppressDisabledCheck;\r\n\t\t\t\tsuppressDisabledCheck = false;\r\n\t\t\t}\r\n\r\n\t\t\t// No element argument, shuffle and use this.element\r\n\t\t\tif ( !handlers ) {\r\n\t\t\t\thandlers = element;\r\n\t\t\t\telement = this.element;\r\n\t\t\t\tdelegateElement = this.widget();\r\n\t\t\t} else {\r\n\t\t\t\telement = delegateElement = $( element );\r\n\t\t\t\tthis.bindings = this.bindings.add( element );\r\n\t\t\t}\r\n\r\n\t\t\tobjects.each( handlers, function( event, handler ) {\r\n\t\t\t\tfunction handlerProxy() {\r\n\r\n\t\t\t\t\t// Allow widgets to customize the disabled handling\r\n\t\t\t\t\t// - disabled as an array instead of boolean\r\n\t\t\t\t\t// - disabled class as method for disabling individual parts\r\n\t\t\t\t\tif ( !suppressDisabledCheck &&\r\n\t\t\t\t\t\t\t( instance.options.disabled === true ||\r\n\t\t\t\t\t\t\t$( this ).hasClass( \"ui-state-disabled\" ) ) ) {\r\n\t\t\t\t\t\treturn;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn ( typeof handler === \"string\" ? instance[ handler ] : handler )\r\n\t\t\t\t\t\t.apply( instance, arguments );\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Copy the guid so direct unbinding works\r\n\t\t\t\tif ( typeof handler !== \"string\" ) {\r\n\t\t\t\t\thandlerProxy.guid = handler.guid =\r\n\t\t\t\t\t\thandler.guid || handlerProxy.guid || $.guid++;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvar match = event.match( /^([\\w:-]*)\\s*(.*)$/ );\r\n\t\t\t\tvar eventName = match[ 1 ] + instance.eventNamespace;\r\n\t\t\t\tvar selector = match[ 2 ];\r\n\r\n\t\t\t\tif ( selector ) {\r\n\t\t\t\t\tdelegateElement.on( eventName, selector, handlerProxy );\r\n\t\t\t\t} else {\r\n\t\t\t\t\telement.on( eventName, handlerProxy );\r\n\t\t\t\t}\r\n\t\t\t} );\r\n\t\t},\r\n\r\n\t\t_off: function( element, eventName ) {\r\n\t\t\teventName = ( eventName || \"\" ).split( \" \" ).join( this.eventNamespace + \" \" ) +\r\n\t\t\t\tthis.eventNamespace;\r\n\t\t\telement.off( eventName );\r\n\r\n\t\t\t// Clear the stack to avoid memory leaks (#10056)\r\n\t\t\tthis.bindings = $( this.bindings.not( element ).get() );\r\n\t\t\tthis.focusable = $( this.focusable.not( element ).get() );\r\n\t\t\tthis.hoverable = $( this.hoverable.not( element ).get() );\r\n\t\t},\r\n\r\n\t\t_trigger: function( type, event, data ) {\r\n\t\t\tvar prop, orig;\r\n\t\t\tvar callback = this.options[ type ];\r\n\r\n\t\t\tdata = data || {};\r\n\t\t\tevent = eventer.proxy( event );\r\n\t\t\tevent.type = ( type === this.widgetEventPrefix ?\r\n\t\t\t\ttype :\r\n\t\t\t\tthis.widgetEventPrefix + type ).toLowerCase();\r\n\r\n\t\t\t// The original event may come from any element\r\n\t\t\t// so we need to reset the target on the new event\r\n\t\t\tevent.target = this.element[ 0 ];\r\n\r\n\t\t\t// Copy original event properties over to the new event\r\n\t\t\torig = event.originalEvent;\r\n\t\t\tif ( orig ) {\r\n\t\t\t\tfor ( prop in orig ) {\r\n\t\t\t\t\tif ( !( prop in event ) ) {\r\n\t\t\t\t\t\tevent[ prop ] = orig[ prop ];\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.element.trigger( event, data );\r\n\t\t\treturn !( types.isFunction( callback ) &&\r\n\t\t\t\tcallback.apply( this.element[ 0 ], [ event ].concat( data ) ) === false ||\r\n\t\t\t\tevent.isDefaultPrevented() );\r\n\t\t},\r\n\r\n\r\n\t    enable: function() {\r\n\t      return this._setOptions( { disabled: false } );\r\n\t    },\r\n\r\n\t    disable: function() {\r\n\t      return this._setOptions( { disabled: true } );\r\n\t    }\r\n\r\n\r\n\t});\r\n\r\n\treturn JqPlugin;\r\n});"]}