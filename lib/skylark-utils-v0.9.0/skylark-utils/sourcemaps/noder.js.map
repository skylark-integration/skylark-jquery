{"version":3,"sources":["noder.js"],"names":["define","skylark","langx","ensureNodes","nodes","copyByClone","isArrayLike","map","call","node","cloneNode","nodeName","elm","chkName","name","toLowerCase","undefined","contents","contentDocument","childNodes","html","innerHTML","this","empty","isString","isNumber","i","length","appendChild","clone","deep","self","isIE","nodeType","document","createElement","each","getAttribs","attr","setAttrib","getAttrib","tag","props","mixin","createFragment","singleTagRE","test","RegExp","$1","fragmentRE","containers","container","dom","slice","forEach","removeChild","contains","child","isChildOf","createTextNode","text","doc","hasChildNodes","firstChild","parent","documentElement","parentNode","isDoc","DOCUMENT_NODE","ownerDoc","ownerDocument","after","placing","refNode","nextSibling","insertBefore","before","prepend","append","remove","replace","oldNode","replaceChild","throb","params","timer","style","time","callback","throbber","className","clearTimeout","unwrap","wrapper","render","setTimeout","traverse","fn","len","reverse","children","wrapperNode","wrapperInner","noder","navigator","userAgent","match","div","table","tableBody","tableRow","tr","tbody","thead","tfoot","td","th","*","Array","prototype"],"mappings":"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","file":"../noder.js","sourcesContent":["define([\r\n    \"./skylark\",\r\n    \"./langx\"\r\n], function(skylark, langx) {\r\n    var isIE = !!navigator.userAgent.match(/Trident/g) || !!navigator.userAgent.match(/MSIE/g),\r\n        fragmentRE = /^\\s*<(\\w+|!)[^>]*>/,\r\n        singleTagRE = /^<(\\w+)\\s*\\/?>(?:<\\/\\1>|)$/,\r\n        div = document.createElement(\"div\"),\r\n        table = document.createElement('table'),\r\n        tableBody = document.createElement('tbody'),\r\n        tableRow = document.createElement('tr'),\r\n        containers = {\r\n            'tr': tableBody,\r\n            'tbody': table,\r\n            'thead': table,\r\n            'tfoot': table,\r\n            'td': tableRow,\r\n            'th': tableRow,\r\n            '*': div\r\n        },\r\n        rootNodeRE = /^(?:body|html)$/i,\r\n        map = Array.prototype.map,\r\n        slice = Array.prototype.slice;\r\n\r\n    function ensureNodes(nodes, copyByClone) {\r\n        if (!langx.isArrayLike(nodes)) {\r\n            nodes = [nodes];\r\n        }\r\n        if (copyByClone) {\r\n            nodes = map.call(nodes, function(node) {\r\n                return node.cloneNode(true);\r\n            });\r\n        }\r\n        return nodes;\r\n    }\r\n\r\n    function nodeName(elm, chkName) {\r\n        var name = elm.nodeName && elm.nodeName.toLowerCase();\r\n        if (chkName !== undefined) {\r\n            return name === chkName.toLowerCase();\r\n        }\r\n        return name;\r\n    };\r\n\r\n    function contents(elm) {\r\n        if (nodeName(elm, \"iframe\")) {\r\n            return elm.contentDocument;\r\n        }\r\n        return elm.childNodes;\r\n    }\r\n\r\n    function html(node, html) {\r\n        if (html === undefined) {\r\n            return node.innerHTML;\r\n        } else {\r\n            this.empty(node);\r\n            html = html || \"\";\r\n            if (langx.isString(html) || langx.isNumber(html)) {\r\n                node.innerHTML = html;\r\n            } else if (langx.isArrayLike(html)) {\r\n                for (var i = 0; i < html.length; i++) {\r\n                    node.appendChild(html[i]);\r\n                }\r\n            } else {\r\n                node.appendChild(html);\r\n            }\r\n        }\r\n    }\r\n\r\n    function clone(node, deep) {\r\n        var self = this,\r\n            clone;\r\n\r\n        // TODO: Add feature detection here in the future\r\n        if (!isIE || node.nodeType !== 1 || deep) {\r\n            return node.cloneNode(deep);\r\n        }\r\n\r\n        // Make a HTML5 safe shallow copy\r\n        if (!deep) {\r\n            clone = document.createElement(node.nodeName);\r\n\r\n            // Copy attribs\r\n            each(self.getAttribs(node), function(attr) {\r\n                self.setAttrib(clone, attr.nodeName, self.getAttrib(node, attr.nodeName));\r\n            });\r\n\r\n            return clone;\r\n        }\r\n    }\r\n\r\n    function createElement(tag, props) {\r\n        var node = document.createElement(tag);\r\n        if (props) {\r\n            langx.mixin(node, props);\r\n        }\r\n        return node;\r\n    }\r\n\r\n    function createFragment(html) {\r\n        // A special case optimization for a single tag\r\n        if (singleTagRE.test(html)) {\r\n            return [createElement(RegExp.$1)];\r\n        } \r\n       \r\n        var name = fragmentRE.test(html) && RegExp.$1\r\n        if (!(name in containers)) {\r\n            name = \"*\"\r\n        }\r\n        var container = containers[name];\r\n        container.innerHTML = \"\" + html;\r\n        dom = slice.call(container.childNodes);\r\n        \r\n        dom.forEach(function(node){\r\n            container.removeChild(node);\r\n        })\r\n\r\n        return dom;\r\n    }\r\n\r\n    function contains(node, child) {\r\n        return isChildOf(child, node);\r\n    }\r\n\r\n    function createTextNode(text) {\r\n        return document.createTextNode(text);\r\n    }\r\n\r\n    function doc() {\r\n        return document;\r\n    }\r\n\r\n    function empty(node) {\r\n        while (node.hasChildNodes()) {\r\n            var child = node.firstChild;\r\n            node.removeChild(child);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function isChildOf(node, parent) {\r\n        if (document.documentElement.contains) {\r\n            return parent.contains(node);\r\n        }\r\n        while (node) {\r\n            if (parent === node) {\r\n                return true;\r\n            }\r\n\r\n            node = node.parentNode;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    function isDoc(node) {\r\n        return node != null && node.nodeType == node.DOCUMENT_NODE\r\n    }\r\n\r\n    function ownerDoc(elm) {\r\n        if (!elm) {\r\n            return document;\r\n        }\r\n\r\n        if (elm.nodeType == 9) {\r\n            return elm;\r\n        }\r\n\r\n        return elm.ownerDocument;\r\n    }\r\n\r\n    function after(node, placing, copyByClone) {\r\n        var refNode = node,\r\n            parent = refNode.parentNode;\r\n        if (parent) {\r\n            var nodes = ensureNodes(placing, copyByClone),\r\n                refNode = refNode.nextSibling;\r\n\r\n            for (var i = 0; i < nodes.length; i++) {\r\n                if (refNode) {\r\n                    parent.insertBefore(nodes[i], refNode);\r\n                } else {\r\n                    parent.appendChild(nodes[i]);\r\n                }\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function before(node, placing, copyByClone) {\r\n        var refNode = node,\r\n            parent = refNode.parentNode;\r\n        if (parent) {\r\n            var nodes = ensureNodes(placing, copyByClone);\r\n            for (var i = 0; i < nodes.length; i++) {\r\n                parent.insertBefore(nodes[i], refNode);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function prepend(node, placing, copyByClone) {\r\n        var parentNode = node,\r\n            refNode = parentNode.firstChild,\r\n            nodes = ensureNodes(placing, copyByClone);\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            if (refNode) {\r\n                parentNode.insertBefore(nodes[i], refNode);\r\n            } else {\r\n                parentNode.appendChild(nodes[i]);\r\n            }\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function append(node, placing, copyByClone) {\r\n        var parentNode = node,\r\n            nodes = ensureNodes(placing, copyByClone);\r\n        for (var i = 0; i < nodes.length; i++) {\r\n            parentNode.appendChild(nodes[i]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function remove(node) {\r\n        if (node && node.parentNode) {\r\n            node.parentNode.removeChild(node);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function replace(node, oldNode) {\r\n        oldNode.parentNode.replaceChild(node, oldNode);\r\n        return this;\r\n    }\r\n\r\n    function throb(elm, params) {\r\n        var self = this,\r\n            text = params.text,\r\n            style = params.style,\r\n            time = params.time,\r\n            callback = params.callback,\r\n            timer,\r\n            throbber = this.createElement(\"div\", {\r\n                className: params.className || \"throbber\",\r\n                style: style\r\n            }),\r\n            throb = this.createElement(\"div\", {\r\n                className: \"throb\"\r\n            }),\r\n            remove = function() {\r\n                if (timer) {\r\n                    clearTimeout(timer);\r\n                    timer = null;\r\n                }\r\n                if (throbber) {\r\n                    self.unwrap(elm);\r\n                    self.remove(throbber);\r\n                    throbber = null;\r\n                }\r\n            };\r\n        if (text) throb.appendChild(this.createTextNode(text));\r\n        throbber.appendChild(throb);\r\n        this.wrapper(elm, throbber);\r\n        var render = function() {\r\n            if (callback) callback();\r\n        };\r\n        if (time) {\r\n            timer = setTimeout(render, time);\r\n        } else {\r\n            render();\r\n        }\r\n        return {\r\n            remove: remove\r\n        };\r\n    }\r\n\r\n    function traverse(node, fn) {\r\n        fn(node)\r\n        for (var i = 0, len = node.childNodes.length; i < len; i++) {\r\n            traverse(node.childNodes[i], fn);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function reverse(node) {\r\n        var firstChild = node.firstChild;\r\n        for (var i = node.children.length - 1; i > 0; i--) {\r\n            if (i > 0) {\r\n                var child = node.children[i];\r\n                node.insertBefore(child, firstChild);\r\n            }\r\n        }\r\n    }\r\n\r\n    function wrapper(node, wrapperNode) {\r\n        if (langx.isString(wrapperNode)) {\r\n            wrapperNode = this.createFragment(wrapperNode).firstChild;\r\n        }\r\n        node.parentNode.insertBefore(wrapperNode, node);\r\n        wrapperNode.appendChild(node);\r\n    }\r\n\r\n    function wrapperInner(node, wrapperNode) {\r\n        var childNodes = slice.call(node.childNodes);\r\n        node.appendChild(wrapperNode);\r\n        for (var i = 0; i < childNodes.length; i++) {\r\n            wrapperNode.appendChild(childNodes[i]);\r\n        }\r\n        return this;\r\n    }\r\n\r\n    function unwrap(node) {\r\n        var child, parent = node.parentNode;\r\n        if (parent) {\r\n            if (this.isDoc(parent.parentNode)) return;\r\n            parent.parentNode.insertBefore(node, parent);\r\n        }\r\n    }\r\n\r\n    function noder() {\r\n        return noder;\r\n    }\r\n\r\n    langx.mixin(noder , {\r\n        clone: clone,\r\n        contents: contents,\r\n\r\n        createElement: createElement,\r\n\r\n        createFragment: createFragment,\r\n\r\n        contains: contains,\r\n\r\n        createTextNode: createTextNode,\r\n\r\n        doc: doc,\r\n\r\n        empty: empty,\r\n\r\n        html: html,\r\n\r\n        isChildOf: isChildOf,\r\n\r\n        isDoc: isDoc,\r\n\r\n        ownerDoc: ownerDoc,\r\n\r\n        after: after,\r\n\r\n        before: before,\r\n\r\n        prepend: prepend,\r\n\r\n        append: append,\r\n\r\n        remove: remove,\r\n\r\n        replace: replace,\r\n\r\n        throb: throb,\r\n\r\n        traverse: traverse,\r\n\r\n        reverse: reverse,\r\n\r\n        wrapper: wrapper,\r\n\r\n        wrapperInner: wrapperInner,\r\n\r\n        unwrap: unwrap\r\n    });\r\n\r\n    return skylark.noder = noder;\r\n});"]}